<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>MoodMap</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">


<style>
:root{
  --pixel-font: 'Press Start 2P', monospace;
  --bg-main:#0f0b10;
  --bg-panel:#18121a;
  --bg-soft:#1f1722;

  --accent:#ffb4a2;          /* peach */
  --accent2:#cdb4db;         /* lavender */
  --accent-soft: rgba(255,180,162,0.25);

  --text:#f2e9e4;
  --muted:#c9b8b2;

  --border: rgba(255,255,255,0.12);
  --border2: rgba(255,255,255,0.18);

}


*{box-sizing:border-box}
html,body{height:100%}

html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
}

body {
  overflow: hidden;           /* ‚ùó important */
  font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial;
  background: #fdf7ff;       /* fallback only */
  font-family: var(--pixel-font);
  font-size: 12px;
}


.noise{
  display:none !important;
  position:fixed;
  inset:0;
  z-index:-7;
  pointer-events:none;
  opacity:0.02;
  mix-blend-mode: soft-light;
}

/* keep old element (script still uses it) */
.moodGradient{
  position:fixed;
  inset:0;
  z-index:-10;
  background:#000;
  opacity:0;
  pointer-events:none;
}

/* main */
.app{
  max-width:1180px;
  margin:auto;
  padding:26px 26px 80px; /* tighter + cleaner */
}


.emptyHint{
  margin-top: 80px;
  text-align: center;
  font-size: 14px;
  opacity: 0.45;
  letter-spacing: 0.3px;
}


/* ================= Header ================= */
header{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  gap:14px;
  margin-bottom:18px;
  flex-wrap:wrap;
}

.brand{
  display:flex;
  flex-direction:column;
  gap:6px;
}
.title{
  font-size:32px;
  font-weight:1000;
  letter-spacing:-0.6px;
}
.subtitle{
  color:rgba(255,255,255,0.62);
  font-size:13px;
  margin-top:0px;
}

/* ‚úÖ right actions */
.userbox{
  display:flex;
  gap:10px;
  align-items:center;
  flex-wrap:wrap;
  justify-content:flex-end;
}

.welcomeChip{
  padding:10px 14px;
  border-radius:6px;
  border:1px solid var(--border);
  background: rgba(255,255,255,0.05);
  font-size:13px;
  color:rgba(255,255,255,0.88);
}

/* ================= Top buttons ================= */
.topBtn{
  color:white;
  text-decoration:none;
  font-weight:1000;
  padding:10px 14px;
  border-radius:999px;
  border:1px solid var(--border);
  background:rgba(255,255,255,0.05);
  transition: transform .16s ease, box-shadow .16s ease, border .16s ease;
  cursor:pointer;
}
.topBtn:hover{
  transform: translateY(-2px);
  border-color: var(--border2);
  box-shadow: 0 18px 60px rgba(0,0,0,0.60);
}

.logoutBtn{
  color:white;
  text-decoration:none;
  font-weight:1000;
  padding:10px 14px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,0.14);
  background:rgba(239,68,68,0.14);
  transition: transform .16s ease, box-shadow .16s ease;
}
.logoutBtn:hover{
  transform: translateY(-2px);
  box-shadow: 0 18px 60px rgba(239,68,68,0.18);
}

/* ================= Search Users ================= */
.searchWrap{
  position:relative;
}

.userSearch{
  width:270px;
  background: rgba(255,255,255,0.05);
  border:1px solid var(--border);
  color:var(--text);
  padding:10px 12px 10px 36px;
  border-radius:999px;
  font-size:13px;
  outline:none;
  transition: border .2s ease, box-shadow .2s ease;
}
.userSearch:focus{
  border-color: rgba(255,255,255,0.26);
  box-shadow: 0 25px 90px rgba(167,139,250,0.12);
}

.searchIcon{
  position:absolute;
  left:12px;
  top:50%;
  transform:translateY(-50%);
  opacity:.7;
  font-size:14px;
  pointer-events:none;
}

.searchDrop{
  position:absolute;
  right:0;
  top:46px;
  width:380px;
  max-width:90vw;
  border-radius:20px;
  border:1px solid rgba(255,255,255,0.16);
  background: linear-gradient(180deg, rgba(25,30,45,0.94), rgba(10,12,20,0.86));
  backdrop-filter: blur(8px);
  box-shadow: 0 50px 150px rgba(0,0,0,0.80);
  overflow:hidden;
  display:none;
  z-index:200;
}

/* ================= Panel ================= */
.panel{
  margin-top:18px;
  border-radius:24px;
  padding: 14px 16px;
  border:1px solid rgba(255,255,255,0.14);
  backdrop-filter: blur(14px);
  box-shadow:
    0 18px 60px rgba(0,0,0,0.35); /* softer */
}


.controls{
  display:flex;
  gap:14px;
  align-items:center;
  flex-wrap:wrap;
  background:none !important;
}

select, input[type="text"]{
  background: #fff !important;
  color: #000 !important;
  border-radius: 6px !important;
  border: 3px solid #000 !important;
  font-family: var(--pixel-font);
  font-size: 11px;
}

input[type="text"]{
  width:340px
}

button:hover{
  transform:translateY(-2px);
  box-shadow: 0 18px 70px var(--accent-soft);
}

button:disabled{
  opacity:.55;
  cursor:not-allowed;
  box-shadow:none;
  transform:none;
}

/* results */
.results{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(320px,1fr));
  gap:18px;
  margin-top:22px;
}



/* actions */
.actions{
  position:absolute;
  right:14px;
  top:14px;
  display:flex;
  gap:10px;
}

.iconBtn{
  width:36px;height:36px;border-radius:14px;
  border:1px solid rgba(255,255,255,0.14);
  background:rgba(0,0,0,0.32);
  color:white;
  display:flex;align-items:center;justify-content:center;
  cursor:pointer;
  font-weight:1000;
  transition: transform .16s ease, border .16s ease;
}
.iconBtn:hover{
  transform: translateY(-2px);
  border-color: rgba(255,255,255,0.24);
}
.iconBtn.pinned{
  border-color: var(--accent)
}

/* skeleton */
.skeleton{
  border-radius:24px;
  border:1px solid rgba(255,255,255,0.12);
  background:rgba(255,255,255,0.05);
  height:190px;
  position:relative;
  overflow:hidden;
}
.skeleton::after{
  content:"";
  position:absolute; inset:0;
  background:linear-gradient(90deg,transparent,rgba(255,255,255,0.09),transparent);
  transform:translateX(-100%);
  animation:shimmer 1.4s infinite;
}
@keyframes shimmer{
  to{
    transform:translateX(100%)
  }
}

/* ================= Premium Place Modal ================= */
#modalBackdrop{
  position: fixed;
  inset: 0;
  z-index: 9998;
  opacity: 0;
  pointer-events: none;
  background: rgba(0,0,0,0.55);
  backdrop-filter: blur(16px);
  -webkit-backdrop-filter: blur(16px);
  transition: opacity 240ms cubic-bezier(.2,1,.2,1);
}

#modalBackdrop.active{
  opacity: 1;
  pointer-events: auto;
}

#modal{
  position: fixed;
  left: 50%;
  top: 50%;
  transform: translate(-50%,-50%);
  z-index: 9999;

  width: min(980px, 92vw);
  max-height: 90vh;
  overflow: hidden; /* ‚úÖ IMPORTANT */

  border-radius: 26px;
  border: 1px solid rgba(255,255,255,0.18);

  background: linear-gradient(180deg, rgba(20,22,35,0.82), rgba(0,0,0,0.72));
  box-shadow:
    0 70px 200px rgba(0,0,0,0.82),
    0 1px 0 rgba(255,255,255,0.05) inset;

  opacity: 0;
  pointer-events: none;

  transition:
    transform 220ms cubic-bezier(.18,.9,.25,1),
    opacity 180ms ease;
}


#modal.active{
  opacity: 1;
  pointer-events: auto;
  transform: translate(-50%,-50%) scale(1);
}

#modalInner{
  max-height: calc(90vh - 60px);
  overflow-y: auto;
  animation: modalInnerIn 360ms cubic-bezier(.2,.8,.2,1);
}

@keyframes modalInnerIn{
  from{
    opacity:0;
    transform: translateY(10px) scale(0.985);
  }
  to{
    opacity:1;
    transform:none;
  }
}


/* ===========================================================
   ‚úÖ Floating Follow Requests Panel (Bottom-right corner)
   =========================================================== */
#reqBackdrop{
  display:none; /* ‚úÖ remove full screen overlay */
}

#reqModal{
  position: fixed;
  right: 22px;
  bottom: 22px;
  z-index: 12000;

  width: min(420px, calc(100vw - 44px));
  max-height: 58vh;
  overflow: auto;

  border-radius: 22px;
  border: 1px solid rgba(255,255,255,0.16);
  background: linear-gradient(180deg, rgba(20,22,35,0.92), rgba(0,0,0,0.75));
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);

  box-shadow: 0 40px 140px rgba(0,0,0,0.82);

  opacity: 0;
  pointer-events: none;
  transform: translateY(16px) scale(0.98);
  transition: opacity 240ms cubic-bezier(.2,1,.2,1),
              transform 240ms cubic-bezier(.2,1,.2,1);
}
#reqModal.active{
  opacity: 1;
  pointer-events: auto;
  transform: translateY(0) scale(1);
}

.reqInner{
  padding: 14px 14px 12px; 
}
.reqTitle{ 
  margin:0; 
  font-size:15px; 
  font-weight:1000; 
}
.reqSub{ 
  margin-top:6px; 
  font-size:12px; 
  opacity:.70; 
}

.reqList{ 
  margin-top:12px; 
}

.smallBtn{
  border:none;
  color:white;
  font-weight:1000;
  cursor:pointer;
  border-radius:14px;
  padding:9px 12px;
  background: rgba(255,255,255,0.08);
}
.smallBtn.primary{
  background: linear-gradient(135deg,var(--accent),var(--accent2));
}
.smallBtn.danger{
  background: rgba(239,68,68,0.18);
  border:1px solid rgba(239,68,68,0.20);
}
.smallBtn.reqClose{
  margin-left:auto;
  width:38px;
  height:38px;
  display:grid;
  place-items:center;
  padding:0;
  border-radius:14px;
}

.reqItem{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:12px;

  padding:12px;
  border-radius:18px;

  border:1px solid rgba(255,255,255,0.10);
  background: rgba(0,0,0,0.20);
  margin-bottom:10px;
}
.reqUser{ 
  font-weight:1000; 
  font-size:13px; 
}
.reqMeta{ 
  font-size:12px; 
  opacity:.68; 
  margin-top:4px;
 }
.reqBtns{ 
  display:flex; 
  gap:10px; 
}


/* ===========================================================
   üÜï SPLIT GLASS PLACE MODAL (Map + Details)
   =========================================================== */

.modalInner.splitModal{
  display:grid;
  grid-template-columns: 1.15fr 0.85fr;
  padding:0;
  overflow:hidden;
  max-height: 86vh;
}

/* LEFT SIDE ‚Äì MAP */
.splitMap{
  position:relative;
  min-height:440px;
  background: rgba(0,0,0,0.35);
}

.splitMap iframe{
  width:100%;
  height:100%;
  border:none;

  filter:
    saturate(1.15)
    contrast(0.92)
    brightness(1.06);

  transform: scale(1.02);
}

/* cartoon-ish soft overlay */
.splitMap::after{
  content:"";
  position:absolute;
  inset:0;
  pointer-events:none;

  background:
    radial-gradient(
      circle at 20% 20%,
      rgba(255,255,255,0.10),
      transparent 45%
    ),
    linear-gradient(
      180deg,
      rgba(255,255,255,0.05),
      rgba(0,0,0,0.22)
    );
}

/* RIGHT SIDE ‚Äì DETAILS */
.splitDetails{
  padding:22px 22px 20px;
  display:flex;
  flex-direction:column;
  gap:16px;
  overflow-y: auto;
  scrollbar-width: thin;
}

/* HEADER */
.splitHeader{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  gap:12px;
  padding-bottom:14px;
  border-bottom:1px solid rgba(255,255,255,0.08);
}

.splitTitle{
   font-size:20px;
  line-height:1.2;
  font-weight:1000;
  letter-spacing:-0.4px;
}


.splitMeta{
  margin-top:6px;
  display:flex;
  gap:8px;
  flex-wrap:wrap;
}

.badge{
  padding:6px 10px;
  border-radius:999px;
  font-size:12px;
  border:1px solid rgba(255,255,255,0.14);
  background: rgba(255,255,255,0.06);
}

/* INFO ROWS */
.infoRow{
  display:flex;
  gap:12px;
  align-items:flex-start;

  padding:10px 12px;
  border-radius:14px;

  background: rgba(255,255,255,0.05);
  border:1px solid rgba(255,255,255,0.10);

  font-size:13px;
}


.infoRow:hover{
  transform: translateY(-1px);
  box-shadow:
    0 18px 45px rgba(0,0,0,0.45),
    0 1px 0 rgba(255,255,255,0.06) inset;
}


.infoIcon{
  width:28px;
  height:28px;
  border-radius:10px;

  display:grid;
  place-items:center;

  background: rgba(255,255,255,0.06);
  border:1px solid rgba(255,255,255,0.10);
}

/* ACTION BAR */
.splitActions{
  margin-top:auto;
  display:flex;
  gap:12px;
}

.splitActions button{
  flex:1;
  border-radius:14px;
  padding:12px;
  font-weight:1000;
}

/* FIX action links inside place modal */
.splitActions .linkBtn{
  flex:1;
  text-align:center;
  text-decoration:none;

  padding:12px;
  border-radius:14px;

  font-weight:1000;
  font-size:14px;
  color:white;

  background: linear-gradient(135deg,var(--accent),var(--accent2));
  box-shadow: 0 14px 40px rgba(0,0,0,0.35);

  transition:
    transform .16s ease,
    box-shadow .16s ease,
    filter .16s ease;
}

.splitActions .linkBtn:hover{
  transform: translateY(-2px);
  box-shadow: 0 22px 60px rgba(0,0,0,0.45);
  filter: brightness(1.05);
}

.splitActions .linkBtn:active{
  transform: translateY(0);
}

.splitActions .linkBtn:nth-child(2){
  background: rgba(255,255,255,0.10);
  border:1px solid rgba(255,255,255,0.16);
  box-shadow:none;
}

/* ===========================================================
   üÜï CLEAN PLACE MODAL (NO MAP / NO SPLIT)
=========================================================== */

.modalInner.cleanModal{
  display:flex;
  flex-direction:column;
  gap:18px;
  padding:22px;
}

/* header */
.cleanHeader{
  display:flex;
  justify-content:space-between;
  gap:14px;
}

.cleanTitle{
  font-size:22px;
  font-weight:1000;
  letter-spacing:-0.4px;
}

.cleanMeta{
  display:flex;
  gap:8px;
  flex-wrap:wrap;
  margin-top:6px;
}

/* sections */
.cleanSection{
  padding:14px;
  border-radius:18px;
  border:1px solid rgba(255,255,255,0.12);
  background: rgba(255,255,255,0.04);
}

.cleanSectionTitle{
  font-size:13px;
  font-weight:900;
  opacity:.7;
  margin-bottom:8px;
}

/* actions */
.cleanActions{
  display:flex;
  gap:12px;
  margin-top:auto;
}

.cleanActions .linkBtn{
  flex:1;
  text-align:center;
  text-decoration:none;
  padding:12px;
  border-radius:14px;
  font-weight:1000;
  color:white;
  background: linear-gradient(135deg,var(--accent),var(--accent2));
}

.cleanActions .linkBtn.secondary{
  background: rgba(255,255,255,0.10);
  border:1px solid rgba(255,255,255,0.16);
}


/* ===========================================================
   ‚úÖ FIXED SAVED PLACES ROW (PILL STYLE)
=========================================================== */

#savedWrap{
  margin-top: 26px;
}

/* section wrapper */
.savedSection{
  margin-bottom: 18px;
}

/* header */
.savedSectionTitle{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:10px;
  font-size:13px;
  font-weight:900;
  opacity:.9;
}

/* horizontal scroll row */
.carousel{
  display:flex;
  gap:12px;
  overflow-x:auto;
  padding-top: 4px;  
  padding-bottom:6px;
  scroll-snap-type:x mandatory;
}

.carousel::-webkit-scrollbar{
  height:6px;
}
.carousel::-webkit-scrollbar-thumb{
  background:rgba(255,255,255,0.14);
  border-radius:999px;
}

/* üî• THE PILL CARD */
.pinCard{
  flex:0 0 auto;
  height:56px;              /* ‚¨Ü bigger */
  padding:0 20px;           /* ‚¨Ü more breathing room */
  border-radius:16px;       /* ‚¨õ squarer (was 999px) */

  display:flex;
  flex-direction:column;
  justify-content:center;

  background: rgba(255,255,255,0.06);
  border:1px solid rgba(255,255,255,0.14);
  backdrop-filter: blur(14px);

  cursor:pointer;
  white-space:nowrap;

  transition:
    transform .24s cubic-bezier(.2,.8,.2,1),
    background .24s ease,
    border-color .24s ease;
}

.pinCard:hover{
  transform:translateY(-1px);
  background: rgba(255,255,255,0.10);
  border-color: var(--accent);
}

/* text */
.pinCardTitle{
  font-size:13px;
  font-weight:900;
  line-height:1.2;
}

.pinCardMeta{
  font-size:11px;
  opacity:.65;
  margin-top:2px;
}


  .splitMap::before{
  content:"";
  position:absolute;
  inset:0;
  pointer-events:none;
  box-shadow:
    inset 0 0 0 1px rgba(255,255,255,0.06),
    inset 0 -60px 80px rgba(0,0,0,0.45);
}

#modal {
  max-height: 90vh;
  overflow: hidden;
}

#modalInner {
  max-height: calc(90vh - 60px);
  overflow-y: auto;
}
/* base structure only */
.panel,
#modal{
  border-radius:22px;
  border:1px solid var(--border);
}



button,
.linkBtn,
.topBtn{
  background: linear-gradient(135deg,var(--accent),var(--accent2)) !important;
  color:#2b1f23 !important;
  font-weight:900;
  border-radius:18px;
}


button:hover,
.linkBtn:hover{
  transform: translateY(-2px);
  box-shadow: 0 20px 50px rgba(255,180,162,0.35);
}


select:focus,
input:focus{
  border-color: var(--accent);
  box-shadow: 0 0 0 2px rgba(255,180,162,0.25);
}

.welcomeChip{
  background: rgba(255,180,162,0.12);
  color: var(--text);
  border:1px solid rgba(255,180,162,0.25);
}

.badge{
  background: rgba(205,180,219,0.18);
  border:1px solid rgba(205,180,219,0.35);
  color: var(--text);
}

.sceneLayer{
  filter: saturate(0.75) brightness(0.9);
}


/* ===== TAB ===== */
/* ===========================
   ü™ü PIXEL BROWSER TABS (FIXED)
=========================== */

.tabsBar {
  display: flex;
  align-items: center;          /* üîë IMPORTANT */
  gap: 6px;
}


/* BASE TAB */
.tab {
  height: 26px;                 /* browser tab height */
  min-width: 88px;
  padding: 0 14px;

  display: flex;
  align-items: center;
  gap: 8px;

  background: #ede9fe;
  border: 3px solid #000;

  font-family: var(--pixel-font);
  font-size: 11px;
  line-height: 1;

  box-shadow: 3px 3px 0 #000;
  cursor: pointer;

  position: relative;           /* ‚ùå NO top offset */
}


/* TAB TEXT */
.tabTitle {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* ACTIVE TAB */
.tab.active {
  background: #ffffff;
  top: 0;                       /* ‚¨Ü sits higher */
  box-shadow: 4px 4px 0 #000;
  z-index: 5;
}

/* HOVER */
.tab:hover {
  transform: translate(-1px, -1px);
}

/* CLOSE BUTTON */
.tabClose {
  font-size: 10px;
  line-height: 1;
  padding: 2px 6px;

  border: 2px solid #000;
  background: #fca5a5;
  cursor: pointer;
}

/* ADD TAB (+) */
.tab.addTab {
   min-width: auto;
  padding: 0 12px;
  font-size: 16px;
  font-weight: 900;
  opacity: 0.8;
}
.tab.addTab:hover {
  opacity: 1;
}

/* WINDOW FRAME */

.windowChrome {
  background: #e9d5ff;
  border: 4px solid #000;
  border-radius: 8px;
  box-shadow: 6px 6px 0 #000;
  overflow: hidden;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}


.windowTop {
  height: 44px;                 /* browser-like */
  display: flex;
  align-items: center;          /* üîë SAME BASELINE */
  gap: 12px;

  padding: 0 12px;
  background: #ddd6fe;

  border-bottom: 4px solid #000;
  position: relative;
}


.windowControls {
  display: flex;
  gap: 8px;
  margin-right: 10px;
}

.windowControls .dot {
  width: 12px;
  height: 12px;
  border: 3px solid #000;
}


.dot.red { background:#f87171 }
.dot.yellow { background:#facc15 }
.dot.green { background:#4ade80 }

/* ===========================================================
   üé® MOOD FILTERS ‚Äî WINDOW CHROME
=========================================================== */

.windowChrome.mood-work {
  filter: saturate(0.9) brightness(0.95) hue-rotate(-6deg);
}

.windowChrome.mood-date {
  filter: saturate(1.05) brightness(1) hue-rotate(10deg);
}

.windowChrome.mood-budget {
  filter: saturate(0.7) brightness(0.9) grayscale(0.1);
}

/* ===========================================================
   üé¥ CARD + PANEL INSIDE WINDOW
=========================================================== */

.windowChrome .panel{
  background: linear-gradient(
    180deg,
    rgba(255,255,255,0.95),
    rgba(245,240,255,0.98)
  );
  border: 3px solid #000;
  box-shadow: 6px 6px 0 #000;
}

.windowChrome * {
  pointer-events: auto;
}

.windowChrome .card{
  background:#fff;
  border:3px solid #000;
  border-radius:16px;
  box-shadow: 6px 6px 0 #000;
}

.windowChrome .card:hover{
  transform: translateY(-3px);
}

/* ===========================================================
   üß± PIXEL PLACE CARDS ‚Äî FINAL FIX
=========================================================== */

.card,
.placeCard {
  background: #ffffff;
  color: #000;

  border: 3px solid #000;
  border-radius: 10px;

  /* pixel shadow (NO blur) */
  box-shadow: 6px 6px 0 #000;

  padding: 16px 18px;
  font-family: var(--pixel-font);
  animation: cardIn 0.25s ease;
  transition:
    transform 0.15s ease,
    box-shadow 0.15s ease;
}

@keyframes cardIn {
  from {
    opacity: 0;
    transform: translateY(10px) scale(0.98);
  }
  to {
    opacity: 1;
    transform: none;
  }
}

.card {
  position: relative;
  animation-delay: calc(var(--i, 0) * 80ms);
}

/* top squiggle */
.card::before {
  content: "";
  position: absolute;
  top: -10px;
  left: 24px;
  width: 48px;
  height: 12px;
  border-top: 3px solid #000;
  border-radius: 12px;
}

/* bottom accent line */
.card::after {
  content: "";
  position: absolute;
  bottom: -8px;
  right: 28px;
  width: 36px;
  height: 10px;
  border-bottom: 3px solid #000;
  border-radius: 10px;
}

@keyframes floaty {
  0% { transform: translateY(0); }
  50% { transform: translateY(-2px); }
  100% { transform: translateY(0); }
}

.card::before,
.card::after {
  animation: floaty 3s ease-in-out infinite;
  pointer-events: none;
}

/* hover = slight lift */
.card:hover,
.placeCard:hover {
  transform: translate(-2px, -2px);
  box-shadow: 10px 10px 0 #000;
}

/* title */
.card h3,
.placeTitle {
  font-size: 13px;
  line-height: 1.4;
  margin-bottom: 8px;
}

/* meta text */
.card p,
.placeSub {
  font-size: 11px;
  line-height: 1.6;
  opacity: 0.85;
}

/* badges (Cafe, AI Pick, etc.) */
.badge {
  border: 2px solid #000;
  background: #fef3c7;
  color: #000;
  font-size: 10px;
  padding: 4px 8px;
  border-radius: 8px;
}

/* distance / time row */
.card .metaRow,
.card .infoRow {
  margin-top: 6px;
  font-size: 10px;
  line-height: 1.6;
}

/* ===========================================================
   üé® HAND-DRAWN DECORATIVE LINES
=========================================================== */

/* top scribbles */
.windowTop::after {
  content: "";
  position: absolute;
  left: 120px;
  top: 6px;
  width: 120px;
  height: 8px;
  border-top: 3px solid #000;
  border-radius: 100px;
  opacity: 0.7;
}

/* little bumps in center */
.windowTop::before {
  content: "";
  position: absolute;
  left: 50%;
  top: 10px;
  width: 40px;
  height: 12px;
  border: 3px solid #000;
  border-bottom: none;
  border-radius: 100px 100px 0 0;
  transform: translateX(-50%);
  opacity: 0.6;
}

/* bottom left squiggle */
.windowChrome .decorSquiggle {
  position: absolute;
  bottom: 12px;
  left: 40px;
  width: 60px;
  height: 14px;
  border: 3px solid #000;
  border-top: none;
  border-radius: 0 0 100px 100px;
  opacity: 0.6;
  pointer-events: none;
}


/* bottom right corner box */
.windowChrome::after {
  content: "";
  position: absolute;
  bottom: 10px;
  right: 30px;
  width: 14px;
  height: 14px;
  border: 3px solid #000;
  opacity: 0.6;
}

/* ===========================================================
   ‚ú® SUBTLE IDLE ANIMATIONS
=========================================================== */

@keyframes floaty {
  0%   { transform: translateY(0); }
  50%  { transform: translateY(-2px); }
  100% { transform: translateY(0); }
}

@keyframes blink {
  0%, 90%, 100% { opacity: 0.6; }
  95% { opacity: 0.2; }
}

/* window gently floats */
.windowChrome {
  animation: floaty 6s ease-in-out infinite;
}

/* decorative lines blink slightly */
.windowTop::after,
.windowChrome::before,
.windowChrome::after {
  animation: blink 5s infinite;
}

/* ===========================
   üß† TAB PAGE VISIBILITY FIX
=========================== */

.tabPage {
  display: none;
  height: 100%;
  animation: fadeTab 0.18s steps(2) both;
}
@keyframes fadeTab {
  from { opacity: 0 }
  to { opacity: 1 }
}

.tabPage.active {
  display: block;
}


.tabViewport {
  flex: 1;
  overflow-y: auto;
  position: relative;
  z-index: 1;
}



/* ===========================================================
   üß± PIXELATE ALL CONTROLS (INPUTS / BUTTONS / CHIPS)
=========================================================== */

button,
select,
input[type="text"],
.welcomeChip,
.topBtn,
.logoutBtn {
  font-family: var(--pixel-font);
  border-radius: 6px !important;
  border: 3px solid #000 !important;
  background: #fff !important;
  color: #000 !important;

  box-shadow: 4px 4px 0 #000 !important;
  padding: 10px 14px !important;

  transition: transform 0.12s ease, box-shadow 0.12s ease;
}

/* ===== PIXEL PRESS EFFECT ===== */
button:active,
.topBtn:active,
.logoutBtn:active {
  transform: translate(2px, 2px);
  box-shadow: 2px 2px 0 #000 !important;
}


button:hover,
.topBtn:hover,
.logoutBtn:hover {
  transform: translate(-2px, -2px);
  box-shadow: 8px 8px 0 #000 !important;
}

select {
  appearance: none;
  background: #fff;
  border-radius: 6px;
  border: 3px solid #000;
  font-family: var(--pixel-font);
  font-size: 11px;
  padding-right: 28px;
  background-image:
    linear-gradient(45deg, transparent 50%, black 50%),
    linear-gradient(135deg, black 50%, transparent 50%);
  background-position:
    calc(100% - 14px) 50%,
    calc(100% - 9px) 50%;
  background-size: 5px 5px;
  background-repeat: no-repeat;
}

/* ===== FAKE PIXEL CURSOR ===== */
.pixelInputWrap {
  position: relative;
}

.pixelCaret {
  position: absolute;
  left: 12px;
  top: 50%;
  width: 8px;
  height: 14px;
  background: #000;
  transform: translateY(-50%);
  animation: caretBlink 1s steps(1) infinite;
  pointer-events: none;
}

@keyframes caretBlink {
  50% { opacity: 0; }
}

/* ===== CRT SCANLINES ===== */
.windowChrome::before {
  content:"";
  position:absolute;
  inset:0;
  pointer-events:none;
  background:
    repeating-linear-gradient(
      to bottom,
      rgba(0,0,0,0.05),
      rgba(0,0,0,0.05) 1px,
      transparent 1px,
      transparent 3px
    );
  mix-blend-mode: multiply;
  opacity: 0.25;
}


.homeContent,
#results,
.card {
  position: relative;
  z-index: 5;
}



/* MOBILE FALLBACK */
@media (max-width: 860px){
  .modalInner.splitModal{
    grid-template-columns: 1fr;
  }
  .splitMap{
    min-height:300px;
    border-right:1px solid rgba(255,255,255,0.10);
  }
}

</style>
</head>
<body>
<!-- ================= FAKE BROWSER WINDOW ================= -->

<div class="windowChrome">
  <div class="decorSquiggle"></div>


  <!-- ================= TOP BAR ================= -->
  <div class="windowTop">

    <!-- window dots -->
    <div class="windowControls">
      <span class="dot red"></span>
      <span class="dot yellow"></span>
      <span class="dot green"></span>
    </div>

    <!-- tabs -->
    <div id="browserTabs" class="tabsBar">
      <div class="tab active" data-tab="home">
        <span class="tabTitle">MoodMap</span>
      </div>
      <div class="tab addTab">+</div>
    </div>

  </div>

  <!-- ================= TAB VIEWPORT ================= -->
  <div class="tabViewport">

    <!-- ===== HOME TAB PAGE ===== -->
    <div class="tabPage active" data-tab-page="home">
      <div class="app">

        <!-- ================= HEADER PANEL ================= -->
        <div class="panel" style="margin-bottom:22px;">
          <div style="display:flex;justify-content:space-between;align-items:center;gap:16px;flex-wrap:wrap;">

            <!-- Brand -->
            <div>
              <div style="font-size:28px;font-weight:1000;">MoodMap</div>
              <div style="font-size:13px;opacity:.65;">
                Context-aware place discovery
              </div>
            </div>

            <!-- User actions -->
            <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap;">
              <div class="welcomeChip">
                Welcome, {{ user_username }}
              </div>

              <button class="topBtn" id="myProfileBtn">My Profile</button>
              <button class="topBtn" id="copyProfileBtn">Copy Link</button>
              <a href="/logout" class="logoutBtn">Logout</a>
            </div>

          </div>
        </div>

        <!-- ================= SEARCH ================= -->
        <div class="homeHero">
          <div class="panel">
            <div class="controls">
              <select id="mood">
                <option value="work">Work</option>
                <option value="date">Date</option>
                <option value="quick_bite">Quick Bite</option>
                <option value="budget">Budget</option>
              </select>

              <div class="pixelInputWrap">
                <span class="pixelCaret"></span>
                <input
                type="text"
                id="searchInput"
                placeholder="Search places / category..."
                />
              </div>


              <button id="findBtn" disabled>
                Getting location‚Ä¶
              </button>
            </div>
          </div>
        </div>

        <!-- ================= CONTENT ================= -->
        <div class="homeContent">
          <div id="savedWrap"></div>
          <div id="results" class="results"></div>
        </div>

      </div> <!-- /.app -->
    </div> <!-- /.tabPage -->

  </div> <!-- /.tabViewport -->

</div>

<!-- ================= MODALS ================= -->

<div id="modalBackdrop"></div>
<div id="modal">
  <div id="modalInner" class="modalInner cleanModal"></div>
</div>

<div id="reqBackdrop"></div>
<div id="reqModal">
  <div class="reqInner">
    <div style="display:flex;gap:12px;align-items:center;">
      <div>
        <h3 class="reqTitle">Follow Requests</h3>
        <div class="reqSub">Approve or reject pending requests</div>
      </div>
      <button class="smallBtn reqClose" id="reqCloseBtn">‚úï</button>
    </div>
    <div class="reqList" id="reqList"></div>
  </div>
</div>


<!-- ================= SCRIPTS ================= -->

<script>window.MOODMAP_USERNAME = "{{ user_username }}";</script>
<script src="https://unpkg.com/opening_hours@3.6.0/opening_hours.min.js"></script>

<script>window.MOODMAP_USERNAME = "{{ user_username }}";</script>
<script src="https://unpkg.com/opening_hours@3.6.0/opening_hours.min.js"></script>

<!-- üî• TAB SYSTEM MUST COME FIRST -->
<script>
  /* ================= TAB SYSTEM (FIXED) ================= */

  const tabsBar = document.getElementById("browserTabs");
  const tabViewport = document.querySelector(".tabViewport");

  function activateTab(tabId) {
    document.querySelectorAll(".tab").forEach(t => t.classList.remove("active"));
    document.querySelectorAll(".tabPage").forEach(p => p.classList.remove("active"));

    const tab = document.querySelector(`.tab[data-tab="${tabId}"]`);
    if (tab) tab.classList.add("active");

    if (tabId === "home") {
      document
        .querySelector('.tabPage[data-tab-page="home"]')
        ?.classList.add("active");
      return;
    }

    document
      .querySelector(`.tabPage[data-tab-page="${tabId}"]`)
      ?.classList.add("active");
  }

  function openPlaceTab(placeId, title, placeData = {}) {
    const tabId = "place-" + placeId;

    const existing = document.querySelector(`.tab[data-tab="${tabId}"]`);
    if (existing) {
      activateTab(tabId);
      return;
    }

    const tab = document.createElement("div");
    tab.className = "tab";
    tab.dataset.tab = tabId;
    tab.innerHTML = `
      <span class="tabTitle">${title}</span>
      <span class="tabClose">‚úï</span>
    `;
    tabsBar.insertBefore(tab, tabsBar.querySelector(".addTab"));

    const page = document.createElement("div");
    page.className = "tabPage";
    page.dataset.tabPage = tabId;
    page.innerHTML = `
      <div class="app">
        <div class="panel">
          <h2>${placeData.name || title}</h2>
          <div style="opacity:.7;margin-top:6px">
            ${(placeData.category || "place").replaceAll("_"," ")}
          </div>
        </div>
      </div>
    `;

    tabViewport.appendChild(page);
    activateTab(tabId);
  }

  tabsBar.addEventListener("click", e => {
    if (e.target.classList.contains("tabClose")) return;
    const tab = e.target.closest(".tab");
    if (!tab || tab.classList.contains("addTab")) return;
    activateTab(tab.dataset.tab);
  });

  tabsBar.addEventListener("click", e => {
    if (!e.target.classList.contains("tabClose")) return;
    e.stopPropagation();

    const tab = e.target.closest(".tab");
    const tabId = tab.dataset.tab;
    if (tabId === "home") return;

    const wasActive = tab.classList.contains("active");
    document.querySelector(`.tabPage[data-tab-page="${tabId}"]`)?.remove();
    tab.remove();
    if (wasActive) activateTab("home");
  });

  window.openPlaceTab = openPlaceTab;
</script>

<!-- ‚úÖ MAIN LOGIC COMES AFTER -->
<script src="{{ url_for('static', filename='script.js') }}"></script>

