<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>MoodMap</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">

<style>
:root{
  --bg-main:#0f0b10;
  --bg-panel:#18121a;
  --bg-soft:#1f1722;

  --accent:#ffb4a2;          /* peach */
  --accent2:#cdb4db;         /* lavender */
  --accent-soft: rgba(255,180,162,0.25);

  --text:#f2e9e4;
  --muted:#c9b8b2;

  --border: rgba(255,255,255,0.12);
  --border2: rgba(255,255,255,0.18);

}


*{box-sizing:border-box}
html,body{height:100%}

html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
}

body {
  overflow: hidden;           /* ‚ùó important */
  font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial;
  background: #fdf7ff;        /* fallback only */
}


.noise{
  display:none !important;
  position:fixed;
  inset:0;
  z-index:-7;
  pointer-events:none;
  opacity:0.02;
  background-image:url("https://grainy-gradients.vercel.app/noise.svg");
  mix-blend-mode: soft-light;
}

/* keep old element (script still uses it) */
.moodGradient{
  position:fixed;
  inset:0;
  z-index:-10;
  background:#000;
  opacity:0;
  pointer-events:none;
}

/* main */
.app{
  max-width:1180px;
  margin:auto;
  padding:26px 26px 80px; /* tighter + cleaner */
}


.emptyHint{
  margin-top: 80px;
  text-align: center;
  font-size: 14px;
  opacity: 0.45;
  letter-spacing: 0.3px;
}


/* ================= Header ================= */
header{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  gap:14px;
  margin-bottom:18px;
  flex-wrap:wrap;
}

.brand{
  display:flex;
  flex-direction:column;
  gap:6px;
}
.title{
  font-size:32px;
  font-weight:1000;
  letter-spacing:-0.6px;
}
.subtitle{
  color:rgba(255,255,255,0.62);
  font-size:13px;
  margin-top:0px;
}

/* ‚úÖ right actions */
.userbox{
  display:flex;
  gap:10px;
  align-items:center;
  flex-wrap:wrap;
  justify-content:flex-end;
}

.welcomeChip{
  padding:10px 14px;
  border-radius:999px;
  border:1px solid var(--border);
  background: rgba(255,255,255,0.05);
  font-size:13px;
  color:rgba(255,255,255,0.88);
}

/* ================= Top buttons ================= */
.topBtn{
  color:white;
  text-decoration:none;
  font-weight:1000;
  padding:10px 14px;
  border-radius:999px;
  border:1px solid var(--border);
  background:rgba(255,255,255,0.05);
  transition: transform .16s ease, box-shadow .16s ease, border .16s ease;
  cursor:pointer;
}
.topBtn:hover{
  transform: translateY(-2px);
  border-color: var(--border2);
  box-shadow: 0 18px 60px rgba(0,0,0,0.60);
}

.logoutBtn{
  color:white;
  text-decoration:none;
  font-weight:1000;
  padding:10px 14px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,0.14);
  background:rgba(239,68,68,0.14);
  transition: transform .16s ease, box-shadow .16s ease;
}
.logoutBtn:hover{
  transform: translateY(-2px);
  box-shadow: 0 18px 60px rgba(239,68,68,0.18);
}

/* ================= Search Users ================= */
.searchWrap{
  position:relative;
}

.userSearch{
  width:270px;
  background: rgba(255,255,255,0.05);
  border:1px solid var(--border);
  color:var(--text);
  padding:10px 12px 10px 36px;
  border-radius:999px;
  font-size:13px;
  outline:none;
  transition: border .2s ease, box-shadow .2s ease;
}
.userSearch:focus{
  border-color: rgba(255,255,255,0.26);
  box-shadow: 0 25px 90px rgba(167,139,250,0.12);
}

.searchIcon{
  position:absolute;
  left:12px;
  top:50%;
  transform:translateY(-50%);
  opacity:.7;
  font-size:14px;
  pointer-events:none;
}

.searchDrop{
  position:absolute;
  right:0;
  top:46px;
  width:380px;
  max-width:90vw;
  border-radius:20px;
  border:1px solid rgba(255,255,255,0.16);
  background: linear-gradient(180deg, rgba(25,30,45,0.94), rgba(10,12,20,0.86));
  backdrop-filter: blur(8px);
  box-shadow: 0 50px 150px rgba(0,0,0,0.80);
  overflow:hidden;
  display:none;
  z-index:200;
}

/* ================= Panel ================= */
.panel{
  margin-top:18px;
  border-radius:24px;
  padding:18px;
  border:1px solid rgba(255,255,255,0.14);
  backdrop-filter: blur(14px);
  box-shadow:
    0 18px 60px rgba(0,0,0,0.35); /* softer */
}


.controls{
  display:flex;
  gap:14px;
  align-items:center;
  flex-wrap:wrap;
}

select, input[type="text"]{
  background:rgba(255,255,255,0.05);
  border:1px solid rgba(255,255,255,0.12);
  color:var(--text);
  padding:12px 14px;
  border-radius:16px;
  font-size:14px;
  outline:none;
}

input[type="text"]{width:340px}

button{
  margin-left:auto;
  background:linear-gradient(135deg,var(--accent),var(--accent2));
  border:none;
  color:white;
  padding:12px 18px;
  border-radius:16px;
  font-weight:1000;
  cursor:pointer;
  transition: transform .16s ease, box-shadow .16s ease;
}
button:hover{
  transform:translateY(-2px);
  box-shadow: 0 18px 70px var(--accent-soft);
}
button:disabled{
  opacity:.55;
  cursor:not-allowed;
  box-shadow:none;
  transform:none;
}

/* results */
.results{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(320px,1fr));
  gap:18px;
  margin-top:22px;
}



/* actions */
.actions{
  position:absolute;
  right:14px;
  top:14px;
  display:flex;
  gap:10px;
}

.iconBtn{
  width:36px;height:36px;border-radius:14px;
  border:1px solid rgba(255,255,255,0.14);
  background:rgba(0,0,0,0.32);
  color:white;
  display:flex;align-items:center;justify-content:center;
  cursor:pointer;
  font-weight:1000;
  transition: transform .16s ease, border .16s ease;
}
.iconBtn:hover{
  transform: translateY(-2px);
  border-color: rgba(255,255,255,0.24);
}
.iconBtn.pinned{border-color: var(--accent)}

/* skeleton */
.skeleton{
  border-radius:24px;
  border:1px solid rgba(255,255,255,0.12);
  background:rgba(255,255,255,0.05);
  height:190px;
  position:relative;
  overflow:hidden;
}
.skeleton::after{
  content:"";
  position:absolute; inset:0;
  background:linear-gradient(90deg,transparent,rgba(255,255,255,0.09),transparent);
  transform:translateX(-100%);
  animation:shimmer 1.4s infinite;
}
@keyframes shimmer{to{transform:translateX(100%)}}

/* ================= Premium Place Modal ================= */
#modalBackdrop{
  position: fixed;
  inset: 0;
  z-index: 9998;
  opacity: 0;
  pointer-events: none;
  background: rgba(0,0,0,0.55);
  backdrop-filter: blur(16px);
  -webkit-backdrop-filter: blur(16px);
  transition: opacity 240ms cubic-bezier(.2,1,.2,1);
}

#modalBackdrop.active{
  opacity: 1;
  pointer-events: auto;
}

#modal{
  position: fixed;
  left: 50%;
  top: 50%;
  transform: translate(-50%,-50%);
  z-index: 9999;

  width: min(980px, 92vw);
  max-height: 90vh;
  overflow: hidden; /* ‚úÖ IMPORTANT */

  border-radius: 26px;
  border: 1px solid rgba(255,255,255,0.18);

  background: linear-gradient(180deg, rgba(20,22,35,0.82), rgba(0,0,0,0.72));
  box-shadow:
    0 70px 200px rgba(0,0,0,0.82),
    0 1px 0 rgba(255,255,255,0.05) inset;

  opacity: 0;
  pointer-events: none;

  transition:
    transform 220ms cubic-bezier(.18,.9,.25,1),
    opacity 180ms ease;
}


#modal.active{
  opacity: 1;
  pointer-events: auto;
  transform: translate(-50%,-50%) scale(1);
}

#modalInner{
  max-height: calc(90vh - 60px);
  overflow-y: auto;
  animation: modalInnerIn 360ms cubic-bezier(.2,.8,.2,1);
}

@keyframes modalInnerIn{
  from{
    opacity:0;
    transform: translateY(10px) scale(0.985);
  }
  to{
    opacity:1;
    transform:none;
  }
}


/* ===========================================================
   ‚úÖ Floating Follow Requests Panel (Bottom-right corner)
   =========================================================== */
#reqBackdrop{
  display:none; /* ‚úÖ remove full screen overlay */
}

#reqModal{
  position: fixed;
  right: 22px;
  bottom: 22px;
  z-index: 12000;

  width: min(420px, calc(100vw - 44px));
  max-height: 58vh;
  overflow: auto;

  border-radius: 22px;
  border: 1px solid rgba(255,255,255,0.16);
  background: linear-gradient(180deg, rgba(20,22,35,0.92), rgba(0,0,0,0.75));
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);

  box-shadow: 0 40px 140px rgba(0,0,0,0.82);

  opacity: 0;
  pointer-events: none;
  transform: translateY(16px) scale(0.98);
  transition: opacity 240ms cubic-bezier(.2,1,.2,1),
              transform 240ms cubic-bezier(.2,1,.2,1);
}
#reqModal.active{
  opacity: 1;
  pointer-events: auto;
  transform: translateY(0) scale(1);
}

.reqInner{ padding: 14px 14px 12px; }
.reqTitle{ margin:0; font-size:15px; font-weight:1000; }
.reqSub{ margin-top:6px; font-size:12px; opacity:.70; }

.reqList{ margin-top:12px; }

.smallBtn{
  border:none;
  color:white;
  font-weight:1000;
  cursor:pointer;
  border-radius:14px;
  padding:9px 12px;
  background: rgba(255,255,255,0.08);
}
.smallBtn.primary{
  background: linear-gradient(135deg,var(--accent),var(--accent2));
}
.smallBtn.danger{
  background: rgba(239,68,68,0.18);
  border:1px solid rgba(239,68,68,0.20);
}
.smallBtn.reqClose{
  margin-left:auto;
  width:38px;
  height:38px;
  display:grid;
  place-items:center;
  padding:0;
  border-radius:14px;
}

.reqItem{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:12px;

  padding:12px;
  border-radius:18px;

  border:1px solid rgba(255,255,255,0.10);
  background: rgba(0,0,0,0.20);
  margin-bottom:10px;
}
.reqUser{ font-weight:1000; font-size:13px; }
.reqMeta{ font-size:12px; opacity:.68; margin-top:4px; }
.reqBtns{ display:flex; gap:10px; }


/* ===========================================================
   üÜï SPLIT GLASS PLACE MODAL (Map + Details)
   =========================================================== */

.modalInner.splitModal{
  display:grid;
  grid-template-columns: 1.15fr 0.85fr;
  padding:0;
  overflow:hidden;
  max-height: 86vh;
}

/* LEFT SIDE ‚Äì MAP */
.splitMap{
  position:relative;
  min-height:440px;
  background: rgba(0,0,0,0.35);
}

.splitMap iframe{
  width:100%;
  height:100%;
  border:none;

  filter:
    saturate(1.15)
    contrast(0.92)
    brightness(1.06);

  transform: scale(1.02);
}

/* cartoon-ish soft overlay */
.splitMap::after{
  content:"";
  position:absolute;
  inset:0;
  pointer-events:none;

  background:
    radial-gradient(
      circle at 20% 20%,
      rgba(255,255,255,0.10),
      transparent 45%
    ),
    linear-gradient(
      180deg,
      rgba(255,255,255,0.05),
      rgba(0,0,0,0.22)
    );
}

/* RIGHT SIDE ‚Äì DETAILS */
.splitDetails{
  padding:22px 22px 20px;
  display:flex;
  flex-direction:column;
  gap:16px;
  overflow-y: auto;
  scrollbar-width: thin;
}

/* HEADER */
.splitHeader{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  gap:12px;
  padding-bottom:14px;
  border-bottom:1px solid rgba(255,255,255,0.08);
}

.splitTitle{
   font-size:20px;
  line-height:1.2;
  font-weight:1000;
  letter-spacing:-0.4px;
}


.splitMeta{
  margin-top:6px;
  display:flex;
  gap:8px;
  flex-wrap:wrap;
}

.badge{
  padding:6px 10px;
  border-radius:999px;
  font-size:12px;
  border:1px solid rgba(255,255,255,0.14);
  background: rgba(255,255,255,0.06);
}

/* INFO ROWS */
.infoRow{
  display:flex;
  gap:12px;
  align-items:flex-start;

  padding:10px 12px;
  border-radius:14px;

  background: rgba(255,255,255,0.05);
  border:1px solid rgba(255,255,255,0.10);

  font-size:13px;
}


.infoRow:hover{
  transform: translateY(-1px);
  box-shadow:
    0 18px 45px rgba(0,0,0,0.45),
    0 1px 0 rgba(255,255,255,0.06) inset;
}


.infoIcon{
  width:28px;
  height:28px;
  border-radius:10px;

  display:grid;
  place-items:center;

  background: rgba(255,255,255,0.06);
  border:1px solid rgba(255,255,255,0.10);
}

/* ACTION BAR */
.splitActions{
  margin-top:auto;
  display:flex;
  gap:12px;
}

.splitActions button{
  flex:1;
  border-radius:14px;
  padding:12px;
  font-weight:1000;
}

/* FIX action links inside place modal */
.splitActions .linkBtn{
  flex:1;
  text-align:center;
  text-decoration:none;

  padding:12px;
  border-radius:14px;

  font-weight:1000;
  font-size:14px;
  color:white;

  background: linear-gradient(135deg,var(--accent),var(--accent2));
  box-shadow: 0 14px 40px rgba(0,0,0,0.35);

  transition:
    transform .16s ease,
    box-shadow .16s ease,
    filter .16s ease;
}

.splitActions .linkBtn:hover{
  transform: translateY(-2px);
  box-shadow: 0 22px 60px rgba(0,0,0,0.45);
  filter: brightness(1.05);
}

.splitActions .linkBtn:active{
  transform: translateY(0);
}

.splitActions .linkBtn:nth-child(2){
  background: rgba(255,255,255,0.10);
  border:1px solid rgba(255,255,255,0.16);
  box-shadow:none;
}

/* ===========================================================
   üÜï CLEAN PLACE MODAL (NO MAP / NO SPLIT)
=========================================================== */

.modalInner.cleanModal{
  display:flex;
  flex-direction:column;
  gap:18px;
  padding:22px;
}

/* header */
.cleanHeader{
  display:flex;
  justify-content:space-between;
  gap:14px;
}

.cleanTitle{
  font-size:22px;
  font-weight:1000;
  letter-spacing:-0.4px;
}

.cleanMeta{
  display:flex;
  gap:8px;
  flex-wrap:wrap;
  margin-top:6px;
}

/* sections */
.cleanSection{
  padding:14px;
  border-radius:18px;
  border:1px solid rgba(255,255,255,0.12);
  background: rgba(255,255,255,0.04);
}

.cleanSectionTitle{
  font-size:13px;
  font-weight:900;
  opacity:.7;
  margin-bottom:8px;
}

/* actions */
.cleanActions{
  display:flex;
  gap:12px;
  margin-top:auto;
}

.cleanActions .linkBtn{
  flex:1;
  text-align:center;
  text-decoration:none;
  padding:12px;
  border-radius:14px;
  font-weight:1000;
  color:white;
  background: linear-gradient(135deg,var(--accent),var(--accent2));
}

.cleanActions .linkBtn.secondary{
  background: rgba(255,255,255,0.10);
  border:1px solid rgba(255,255,255,0.16);
}


/* ===========================================================
   ‚úÖ FIXED SAVED PLACES ROW (PILL STYLE)
=========================================================== */

#savedWrap{
  margin-top: 26px;
}

/* section wrapper */
.savedSection{
  margin-bottom: 18px;
}

/* header */
.savedSectionTitle{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:10px;
  font-size:13px;
  font-weight:900;
  opacity:.9;
}

/* horizontal scroll row */
.carousel{
  display:flex;
  gap:12px;
  overflow-x:auto;
  padding-top: 4px;  
  padding-bottom:6px;
  scroll-snap-type:x mandatory;
}

.carousel::-webkit-scrollbar{
  height:6px;
}
.carousel::-webkit-scrollbar-thumb{
  background:rgba(255,255,255,0.14);
  border-radius:999px;
}

/* üî• THE PILL CARD */
.pinCard{
  flex:0 0 auto;
  height:56px;              /* ‚¨Ü bigger */
  padding:0 20px;           /* ‚¨Ü more breathing room */
  border-radius:16px;       /* ‚¨õ squarer (was 999px) */

  display:flex;
  flex-direction:column;
  justify-content:center;

  background: rgba(255,255,255,0.06);
  border:1px solid rgba(255,255,255,0.14);
  backdrop-filter: blur(14px);

  cursor:pointer;
  white-space:nowrap;

  transition:
    transform .24s cubic-bezier(.2,.8,.2,1),
    background .24s ease,
    border-color .24s ease;
}

.pinCard:hover{
  transform:translateY(-1px);
  background: rgba(255,255,255,0.10);
  border-color: var(--accent);
}

/* text */
.pinCardTitle{
  font-size:13px;
  font-weight:900;
  line-height:1.2;
}

.pinCardMeta{
  font-size:11px;
  opacity:.65;
  margin-top:2px;
}


  .splitMap::before{
  content:"";
  position:absolute;
  inset:0;
  pointer-events:none;
  box-shadow:
    inset 0 0 0 1px rgba(255,255,255,0.06),
    inset 0 -60px 80px rgba(0,0,0,0.45);
}

#modal {
  max-height: 90vh;
  overflow: hidden;
}

#modalInner {
  max-height: calc(90vh - 60px);
  overflow-y: auto;
}
/* base structure only */
.panel,
#modal{
  border-radius:22px;
  border:1px solid var(--border);
}



button,
.linkBtn,
.topBtn{
  background: linear-gradient(135deg,var(--accent),var(--accent2)) !important;
  color:#2b1f23 !important;
  font-weight:900;
  border-radius:18px;
}


button:hover,
.linkBtn:hover{
  transform: translateY(-2px);
  box-shadow: 0 20px 50px rgba(255,180,162,0.35);
}

select,
input[type="text"]{
  background: var(--bg-soft);
  border:1px solid var(--border);
  color:var(--text);
  border-radius:18px;
  padding:12px 16px;
}

select:focus,
input:focus{
  border-color: var(--accent);
  box-shadow: 0 0 0 2px rgba(255,180,162,0.25);
}

.welcomeChip{
  background: rgba(255,180,162,0.12);
  color: var(--text);
  border:1px solid rgba(255,180,162,0.25);
}

.badge{
  background: rgba(205,180,219,0.18);
  border:1px solid rgba(205,180,219,0.35);
  color: var(--text);
}

.sceneLayer{
  filter: saturate(0.75) brightness(0.9);
}

/* ===========================================================
   ü™ü FAKE BROWSER SHELL (PASTEL CARTOON)
=========================================================== */

.browserShell{
  width: 100vw;
  height: 100vh;   
  display: flex;
  flex-direction: column;
  max-width: 100%;
  min-height:100vh;
  margin: 0;
  border-radius: 0;
  background:#fdf7ff;
  box-shadow: none;
  overflow: hidden;  
  border-bottom-left-radius:18px;
  border-bottom-right-radius:18px;
}


/* top bar */
.browserTopBar{
  background: linear-gradient(180deg,#e9c6ff,#f3ddff);
  padding: 10px 14px;
  display: flex;
  align-items: center;
  gap: 14px;
  border-bottom: 2px solid rgba(0,0,0,0.08);
}

/* fake window dots */
.browserDots{
  display:flex;
  gap:6px;
}
.browserDots span{
  width:12px;height:12px;
  border-radius:50%;
  background:#ff9aa2;
}
.browserDots span:nth-child(2){ background:#ffd97d }
.browserDots span:nth-child(3){ background:#b5ead7 }

/* tabs bar */
.browserTabs{
  display:flex;
  gap:6px;
  align-items:flex-end;
  overflow-x:auto;
}

/* tab */
.tab{
  background:#f7eaff;
  border-radius:14px 14px 0 0;
  padding:8px 14px;
  font-weight:900;
  font-size:13px;
  cursor:pointer;
  display:flex;
  align-items:center;
  gap:6px;
  border:2px solid rgba(0,0,0,0.08);
  border-bottom:none;
  opacity:.7;
}

.tab.active{
  background:#fff;
  opacity:1;
}

.tab.addTab{
  padding:8px 12px;
  font-size:16px;
  opacity:.6;
}

/* viewport */
.tabViewport{
  flex: 1;                    /* takes remaining height */
  overflow-y: auto;           /* internal scrolling */
  background: #fff;
    background:
    radial-gradient(
      circle at top center,
      rgba(255,180,162,0.12),
      transparent 55%
    ),
    #fdf7ff;
}


/* tab pages */
.tabPage{
  display:none;
}
.tabPage.active{
  display:block;
}

.results{
  margin-top:32px;
  padding-top:20px;
  border-top:1px dashed rgba(0,0,0,0.08);
}

/* ===========================================================
   üé® BROWSER THEME OVERRIDES (PASTEL MODE)
=========================================================== */

.browserShell .panel{
  background: linear-gradient(
    180deg,
    rgba(255,255,255,0.9),
    rgba(245,240,255,0.95)
  );
  border: 1px solid rgba(0,0,0,0.06);
  box-shadow:
    0 18px 40px rgba(0,0,0,0.12);
  backdrop-filter: none;
}

.browserShell select,
.browserShell input[type="text"]{
  background: #ffffff;
  color:#2b1f23;
  border:1px solid rgba(0,0,0,0.08);
}

.browserShell button{
  background: linear-gradient(135deg,#ffb4a2,#cdb4db);
  color:#2b1f23;
  box-shadow: 0 10px 30px rgba(255,180,162,0.35);
}

/* ===========================================================
   üé® MOOD FILTERS ‚Äî APPLIED TO FAKE BROWSER (NOT BODY)
=========================================================== */

.browserShell.mood-work {
  filter:
    saturate(0.9)
    brightness(0.95)
    hue-rotate(-6deg);
}

.browserShell.mood-date {
  filter:
    saturate(1.05)
    brightness(1)
    hue-rotate(10deg);
}

.browserShell.mood-budget {
  filter:
    saturate(0.7)
    brightness(0.9)
    grayscale(0.1);
}

/* ===========================================================
   üé¥ PHASE 2 ‚Äî PASTEL BROWSER CARDS
=========================================================== */

.browserShell .card{
  background: #fde7ff !important;
  border: 2px solid rgba(0,0,0,0.08) !important;
  border-radius: 26px !important;

  box-shadow:
    0 18px 45px rgba(0,0,0,0.12),
    inset 0 1px 0 rgba(255,255,255,0.6) !important;

  backdrop-filter: none !important;
  padding: 20px !important;
  min-height: 180px;

  cursor: pointer;
  transition: transform .18s ease, box-shadow .18s ease;
}

/* hover = soft lift */

.browserShell .card:hover{
  transform: translateY(-4px);
  box-shadow:
    0 28px 70px rgba(255,180,162,0.35) !important;
}

/* press feel */
.browserShell .card:active{
  transform: scale(0.97);
}

/* card title polish */
.browserShell .card h3{
  color:#2b1f23;
  font-weight:900;
}

/* subtle shine */
.browserShell .card::after{
  content:"";
  display:none !important;
  position:absolute;
  inset:0;
  pointer-events:none;
  background:
    radial-gradient(
      circle at top left,
      rgba(255,255,255,0.6),
      transparent 45%
    );
  opacity:.35;
}

.placeCard {
  max-width: 820px;
  margin: 40px auto;
  padding: 22px 26px;

  border-radius: 22px;
  background: rgba(255,255,255,0.65);
  backdrop-filter: blur(14px);

  box-shadow:
    0 10px 30px rgba(0,0,0,0.08),
    inset 0 1px 0 rgba(255,255,255,0.6);

  transition: all .25s ease;
}

.placeTitle {
  font-size: 18px;
  font-weight: 700;
  color: #1f2937;
}

.placeSub {
  font-size: 13px;
  opacity: 0.65;
  margin-top: 4px;
}

/* ‚úÖ FINAL CARD AUTHORITY ‚Äî PASTEL BROWSER */
.browserShell .results .card{
  background:
    linear-gradient(
      180deg,
      rgba(255,255,255,0.95),
      rgba(245,240,255,0.98)
    ) !important;

  border:1px solid rgba(0,0,0,0.06) !important;
  backdrop-filter: none !important;

  box-shadow:
    0 16px 40px rgba(0,0,0,0.12) !important;
}

/* ===============================
   ü™ü BROWSER-LIKE RESULT CARD
================================ */

.browserShell .card{
  position: relative;
  border-radius: 26px;
  overflow: hidden;
  background: #fde7ff;
  border: 2px solid rgba(0,0,0,0.08);

  box-shadow:
    0 16px 40px rgba(0,0,0,0.14),
    inset 0 1px 0 rgba(255,255,255,0.7);

  transition:
    transform .35s cubic-bezier(.2,.9,.2,1),
    box-shadow .35s ease,
    opacity .2s ease;

  cursor: pointer;
}

/* fake mini browser top bar */
.browserShell .card::before{
  content:"";
  display:block;
  height:32px;
  background: linear-gradient(180deg,#e9b6ff,#f3d6ff);
  border-bottom:2px solid rgba(0,0,0,0.08);
}

/* dots */
.browserShell .card::after{
  content:"";
  position:absolute;
  top:10px;
  right:16px;
  width:42px;
  height:12px;
  background:
    radial-gradient(circle,#ffd97d 5px,transparent 6px),
    radial-gradient(circle,#b5ead7 5px,transparent 6px),
    radial-gradient(circle,#ff9aa2 5px,transparent 6px);
  background-size:12px 12px;
  background-repeat:no-repeat;
  background-position:0 0,15px 0,30px 0;
  opacity:.9;
}

@keyframes cardToTab {
  0% {
    transform: scale(1) translateY(0);
    opacity: 1;
  }
  60% {
    transform: scale(0.85) translateY(-80px);
    opacity: .85;
  }
  100% {
    transform: scale(0.6) translateY(-140px);
    opacity: 0;
  }
}

.card.toTab {
  animation: cardToTab .45s cubic-bezier(.2,.9,.2,1) forwards;
}

.tab.snap{
  animation: tabSnap .35s ease;
}

@keyframes tabSnap{
  0%{
    transform: scale(1);
    box-shadow:none;
  }
  50%{
    transform: scale(1.08);
    box-shadow:0 0 0 4px rgba(255,180,162,0.45);
  }
  100%{
    transform:none;
    box-shadow:none;
  }
}



/* MOBILE FALLBACK */
@media (max-width: 860px){
  .modalInner.splitModal{
    grid-template-columns: 1fr;
  }
  .splitMap{
    min-height:300px;
    border-right:1px solid rgba(255,255,255,0.10);
  }
}

</style>
</head>
<body>
 <div class="browserShell">

  <!-- ================= TOP BAR ================= -->
  <div class="browserTopBar">
    <div class="browserDots">
      <span></span><span></span><span></span>
    </div>

    <div class="browserTabs" id="browserTabs">
      <div class="tab active" data-tab="home">
        <span class="tabIcon">üè†</span>
        <span class="tabTitle">MoodMap</span>
      </div>

      <div class="tab addTab">Ôºã</div>
    </div>
  </div>

  <!-- ================= TAB CONTENT ================= -->
<div class="tabViewport">

  <!-- ===== HOME TAB PAGE ===== -->
  <div class="tabPage active" data-tab-page="home">
    <div class="app">

      <!-- ================= HERO (SEARCH) ================= -->
      <div class="homeHero">
        <div class="panel">
          <div class="controls">
            <select id="mood">
              <option value="work">Work</option>
              <option value="date">Date</option>
              <option value="quick_bite">Quick Bite</option>
              <option value="budget">Budget</option>
            </select>

            <input
              type="text"
              id="searchInput"
              placeholder="Search places / category..."
            />

            <button id="findBtn" disabled>
              Getting location‚Ä¶
            </button>
          </div>
        </div>
      </div>

      <!-- ================= CONTENT (SAVED + RESULTS) ================= -->
      <div class="homeContent">
        <div id="savedWrap"></div>
        <div id="results" class="results"></div>
      </div>

    </div> <!-- /.app -->

  </div> <!-- /.tabPage -->

</div> <!-- /.tabViewport -->


</div> <!-- .browserShell -->


<!-- ================= MODALS (OUTSIDE TABS) ================= -->

<!-- place modal -->
<div id="modalBackdrop"></div>
<div id="modal">
  <div id="modalInner" class="modalInner cleanModal"></div>
</div>

<!-- follow requests floating panel -->
<div id="reqBackdrop"></div>
<div id="reqModal">
  <div class="reqInner">
    <div style="display:flex;gap:12px;align-items:center;">
      <div>
        <h3 class="reqTitle">Follow Requests</h3>
        <div class="reqSub">Approve or reject pending requests</div>
      </div>
      <button class="smallBtn reqClose" id="reqCloseBtn">‚úï</button>
    </div>

    <div class="reqList" id="reqList"></div>
  </div>
</div>
  

<!-- scripts -->
<script>window.MOODMAP_USERNAME = "{{user_username}}";</script>
<script src="https://unpkg.com/opening_hours@3.6.0/opening_hours.min.js"></script>
<script src="/static/script.js"></script>

<script>
const shell = document.querySelector(".browserShell");

function applyMood(mood){
  shell.classList.remove("mood-work","mood-date","mood-budget");
  shell.classList.add("mood-" + mood);
}

const tabsBar = document.getElementById("browserTabs");
const tabViewport = document.querySelector(".tabViewport");

function openPlaceTab(placeId, title){
  // already open?
  const existing = document.querySelector(`.tab[data-place="${placeId}"]`);
  if(existing){
    activateTab(existing.dataset.tab);
    return;
  }

  // create tab id
  const tabId = "place-" + placeId;

  /* ---------- TAB ---------- */
  const tab = document.createElement("div");
  tab.className = "tab";
  tab.dataset.tab = tabId;
  tab.dataset.place = placeId;
  tab.draggable = true;

  tab.innerHTML = `
    <span class="tabTitle">${title}</span>
    <span class="tabClose">‚úï</span>
  `;

  tabsBar.insertBefore(tab, tabsBar.querySelector(".addTab"));

  /* ---------- PAGE ---------- */
  const page = document.createElement("div");
  page.className = "tabPage";
  page.dataset.tabPage = tabId;
  page.innerHTML = `
    <div class="app">
      <div class="panel">
        <strong>${title}</strong>
        <div style="margin-top:10px;opacity:.7">
          Place details will render here
        </div>
      </div>
    </div>
  `;
  tabViewport.appendChild(page);

  activateTab(tabId);
}

/* activate tab */
function activateTab(tabId){
  document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"));
  document.querySelectorAll(".tabPage").forEach(p=>p.classList.remove("active"));

  const tab = document.querySelector(`.tab[data-tab="${tabId}"]`);
  const page = document.querySelector(`.tabPage[data-tab-page="${tabId}"]`);

  if(tab && page){
    tab.classList.add("active");
    page.classList.add("active");
  }
}



let draggedTab = null;

tabsBar.addEventListener("dragstart", e=>{
  const tab = e.target.closest(".tab");
  if(!tab || tab.dataset.tab === "home" || tab.classList.contains("addTab")) return;
  draggedTab = tab;
});


tabsBar.addEventListener("dragover", e=>{
  e.preventDefault();
  const target = e.target.closest(".tab");
  if(target && target !== draggedTab && !target.classList.contains("addTab")){
    tabsBar.insertBefore(draggedTab, target);
  }
});

tabsBar.addEventListener("click", e => {
  if (!e.target.classList.contains("tabClose")) return;
  e.stopPropagation();

  const tab = e.target.closest(".tab");
  const tabId = tab.dataset.tab;
  if (tabId === "home") return;

  const wasActive = tab.classList.contains("active");

  // remove page + tab
  document.querySelector(`.tabPage[data-tab-page="${tabId}"]`)?.remove();
  tab.remove();

  if (!wasActive) return;

  // find LAST visible tab (never empty)
  const remainingTabs = [...document.querySelectorAll(".tab:not(.addTab)")];

  const next =
    remainingTabs[remainingTabs.length - 1] ||
    document.querySelector('.tab[data-tab="home"]');

  activateTab(next.dataset.tab);
});




tabsBar.addEventListener("click", e=>{
  const tab = e.target.closest(".tab");
  if(tab && !tab.classList.contains("addTab")){
    activateTab(tab.dataset.tab);
  }
});


</script>

</body>
</html>
